<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ಪ್ರಜ್ಞಾನಂ - ಬೆಂಗಳೂರು ಉತ್ತರ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <!-- Add these after existing meta tags -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="assets/images/brand/icon.png">
    <link rel="stylesheet" href="assets/style.css">

    <meta name="description" content="Handcrafted by ಜ್ಞಾನ ಸಂಗಮ">
    <meta name="keywords" content="prajnanam,gnanasangama,gnana,sangama,abhyudaya,foundation">
    <meta property="og:title" content="ಪ್ರಜ್ಞಾನಂ - ಬೆಂಗಳೂರು ಉತ್ತರ">
    <meta property="og:description" content="Handcrafted by ಜ್ಞಾನ ಸಂಗಮ">
    <meta property="og:image" content="/assets/images/brand/icon.png">
    <meta property="og:url" content="https://prajnanam.netlify.app/">
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TNM4Z1XVSE"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-TNM4Z1XVSE');
</script>

<body>
    <!-- Header -->
    <nav class="navbar sticky-top bg-white">
        <div class="container-fluid">
            <!-- Home Header -->
            <div class="navbar-brand mb-0 h1 main-header">
                <span style="color: var(--primary-color);">ಪ್ರಜ್ಞಾನಂ - ಬೆಂಗಳೂರು ಉತ್ತರ</span>
            </div>

            <!-- Content Header (Initially Hidden) -->
            <div class="navbar-brand mb-0 h1 content-header" style="display: none;">
                <button class="btn btn-link p-0 me-2 back-button">
                    <i class="bi bi-arrow-left" style="font-size: 1.2rem; color: var(--primary-color);"></i>
                </button>
                <span class="content-title" style="color: var(--primary-color);"></span>
            </div>
        </div>
    </nav>

    <!-- Home Screen -->
    <div class="screen active" id="home-screen">
        <!-- Featured Card -->
        <div class="card app-card mb-3">
            <div class="card-body text-center">
                <h5 class="card-title">ಆಷಾಢ ಮಾಸ</h5>
                <h6 class="card-title">ಶ್ರೀ ವಿಶ್ವಾವಸು ಸಂವತ್ಸರ</h6>
                <p class="card-text">ಜೂನ್ 26 ರಿಂದ ಜುಲೈ 24 2025</p>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <ul class="nav nav-pills nav-fill mb-3" role="tablist">
            <li class="nav-item" role="presentation">
                <div class="tab-card active" data-bs-toggle="tab" data-bs-target="#geethe">
                    <div class="card-body text-center py-2">
                        <i class="bi bi-music-note-beamed mb-1"
                            style="font-size: 1.5rem; color: var(--primary-color);"></i>
                        <h6 class="mb-0">ಗೀತೆ</h6>
                    </div>
                </div>
            </li>
            <li class="nav-item" role="presentation">
                <div class="tab-card" data-bs-toggle="tab" data-bs-target="#amruthavachana">
                    <div class="card-body text-center py-2">
                        <i class="bi bi-quote mb-1" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                        <h6 class="mb-0">ಅಮೃತವಚನ</h6>
                    </div>
                </div>
            </li>
            <li class="nav-item" role="presentation">
                <div class="tab-card" data-bs-toggle="tab" data-bs-target="#shloka">
                    <div class="card-body text-center py-2">
                        <i class="bi bi-journal-text mb-1" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                        <h6 class="mb-0">ಶ್ಲೋಕ</h6>
                    </div>
                </div>
            </li>
            <li class="nav-item" role="presentation">
                <div class="tab-card" data-bs-toggle="tab" data-bs-target="#panchanga">
                    <div class="card-body text-center py-2">
                        <i class="bi bi-calendar3 mb-1" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                        <h6 class="mb-0">ಪಂಚಾಂಗ</h6>
                    </div>
                </div>
            </li>
        </ul>

        <!-- Tabs Content -->
        <div class="tab-content">
            <div class="tab-pane fade show active" id="geethe">
                <div class="card app-card">
                    <div class="card-body">
                        <!-- Existing geethe content -->
                        <div class="content-text">
                            <div class="d-flex justify-content-center mb-3">
                                <div class="song-dropdown-wrapper">
                                    <select id="song-month-select">
                                        <!-- Options will be rendered by JS -->
                                    </select>
                                    <img class="song-dropdown-chevron" src="assets/images/icons/chevron-right.png"
                                        alt="Chevron Icon">
                                </div>
                            </div>
                            <div id="song-content" style=" text-align: center; font-size: 16px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="amruthavachana">
                <!-- Content will be rendered by JavaScript -->
            </div>

            <div class="tab-pane fade" id="shloka">
                <div class="card app-card">
                    <div class="card-body">
                        <!-- Content will be rendered by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="panchanga">
                <div class="card app-card">
                    <div class="card-body text-center" style="padding: 1rem 0.5rem;">
                        <!-- Content will be rendered by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="card app-card my-3">
            <a href="https://play.google.com/store/apps/details?id=app.gnanasangama" class="gnanasangama-playstore-link"
                target="_blank" rel="noopener" style="text-decoration: none;">
                <div class="card-body d-flex align-items-center pb-0">
                    <img src="assets/images/brand/icon-without-bg.png" class="rounded-start" style="width: 4rem;"
                        alt="ಜ್ಞಾನ ಸಂಗಮ">
                    <div class="mx-auto">
                        <div class="text-muted" style="font-size: 0.95rem;">
                            ಇನ್ನೂ ಹೆಚ್ಚಿನ ವಿಷಯಗಳಿಗೆ
                        </div>
                        <h6 class="mt-2 text-center" style="color: var(--primary-color);">ಜ್ಞಾನ ಸಂಗಮ</h6>
                    </div>
                </div>
            </a>
            <hr class="mx-3">
            <div class="card-body align-items-center pt-0">
                <a href="https://ganamala.com/" style="text-decoration: none;" target="_blank">
                    ಗಾನಮಾಲ (Ganamala)
                </a> - [ ಗೀತೆ ]
                <hr>
                <a href="https://www.youtube.com/@sukruthi" style="text-decoration: none;" target="_blank">
                    ಸುಕೃತಿ (Sukruthi)
                </a> - [ ಪುಸ್ತಕದ ಪರಿಚಯ ]
            </div>
        </div>

    </div>

    <!-- Events Screen -->
    <div class="screen" id="events-screen">
        <div class="content-area">
            <!-- Content will be rendered by JavaScript -->
        </div>
    </div>

    <!-- Guide Screen -->
    <div class="screen" id="guide-screen">
        <div class="content-area">
            <div class="row g-2">
                <div class="col-6">
                    <div class="card app-card" data-content="baudhik">
                        <div class="card-body text-center">
                            <i class="bi bi-lightning-charge mb-2"
                                style="font-size: 2rem; color: var(--primary-color);"></i>
                            <h6>ಬೌದ್ಧಿಕ್<br>ಯೋಜನೆ</h6>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card app-card" data-content="sharirik">
                        <div class="card-body text-center">
                            <i class="bi bi-heart-pulse mb-2" style="font-size: 2rem; color: var(--primary-color);"></i>
                            <h6>ಶಾರೀರಿಕ್<br>ಯೋಜನೆ</h6>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card app-card" data-content="shakha">
                        <div class="card-body text-center">
                            <i class="bi bi-book mb-2" style="font-size: 2rem; color: var(--primary-color);"></i>
                            <h6>ಶಾಖಾ ಕೈಪಿಡಿ</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add this after the guide-screen div -->
    <div class="screen" id="baudhik-screen">
        <div class="content-area">
            <!-- Content will be rendered by JavaScript -->
        </div>
    </div>

    <!-- Sharirik Screen -->
    <div class="screen" id="sharirik-screen">
        <div class="content-area">
            <!-- Content will be rendered by JavaScript -->
        </div>
    </div>

    <!-- Shakha Guide Screen -->
    <div class="screen" id="shakha-screen">
        <div class="content-area">
            <!-- Content will be rendered by JavaScript -->
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="row text-center g-0">
            <div class="col nav-item active" data-screen="home-screen">
                <i class="bi bi-house-door-fill nav-icon"></i>
                <div class="nav-text">ಮುಖಪುಟ</div>
            </div>
            <div class="col nav-item" data-screen="events-screen">
                <i class="bi bi-calendar2-week nav-icon"></i>
                <div class="nav-text">ಕಾರ್ಯಕ್ರಮಗಳು</div>
            </div>
            <div class="col nav-item" data-screen="guide-screen">
                <i class="bi bi-book nav-icon"></i>
                <div class="nav-text">ಕೈಪಿಡಿ</div>
            </div>
        </div>
    </div>

    <!-- Floating WhatsApp Button -->
    <a onclick="shareOnWhatsapp()" class="float">
        <i class="fa fa-whatsapp wp-button"></i>
    </a>

    <!-- Floating Quiz Button -->
    <!-- <a id="quiz-float-btn" href="/quiz.html" class="quiz-float-btn hidden">
        <img src="assets/images/quiz.png" alt="Quiz" class="quiz-float-img">
    </a> -->


    <!-- Install Prompt -->
    <div class="install-banner" id="installBanner" style="display: none;">
        <div class="install-message">
            <div style="display: flex; flex-direction: column;align-items: center;width: -webkit-fill-available;">
                <button class="save-app-btn" id="installBtn">Install App</button>
                <span>Install this app for a better experience</span>
            </div>
            <span class="close-btn" id="closeBanner">&times;</span>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/content.js"></script>
    <script src="assets/js/content/songs.js"></script>
    <script src="assets/js/render.js"></script>
    <script>
        // Initialize content when document is ready
        document.addEventListener('DOMContentLoaded', () => {
            renderHomeContent();
            trackVirtualPage('home-screen');

            // floating quiz button logic
            const quizInfo = JSON.parse(localStorage.getItem("quizStatus") || "{}");
            const todayStr = new Date().toISOString().split("T")[0];
            const quizBtn = document.getElementById("quiz-float-btn");

            if (quizBtn) {
                quizBtn.classList.remove("hidden");

                if (!quizInfo.date || quizInfo.date !== todayStr) {
                    // ✅ Not played today – make it bounce
                    quizBtn.classList.add("bounce");
                } else {
                    // ✅ Already played – no bounce
                    quizBtn.classList.remove("bounce");
                }
            }
        });

        // Navigation functionality
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function () {
                // Only handle bottom navigation screens
                if (this.dataset.screen) {
                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');

                    // Show corresponding screen
                    const screenId = this.dataset.screen;
                    document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
                    document.getElementById(screenId).classList.add('active');

                    // Render events content if events screen
                    if (screenId === 'events-screen') {
                        renderEvents();
                    }

                    // Track virtual page view
                    trackVirtualPage(screenId);
                }
            });
        });

        // Update the baudhik card click handler
        document.querySelector('[data-content="baudhik"]').addEventListener('click', function () {
            // Show baudhik screen
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById('baudhik-screen').classList.add('active');

            // Update header
            document.querySelector('.main-header').style.display = 'none';
            document.querySelector('.content-header').style.display = 'flex';
            document.querySelector('.content-title').textContent = 'ಬೌದ್ಧಿಕ್ ಯೋಜನೆ';

            // Render content
            renderBaudhikYojane();
        });

        // Sharirik Yojane handler
        document.querySelector('[data-content="sharirik"]').addEventListener('click', function () {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById('sharirik-screen').classList.add('active');

            document.querySelector('.main-header').style.display = 'none';
            document.querySelector('.content-header').style.display = 'flex';
            document.querySelector('.content-title').textContent = 'ಶಾರೀರಿಕ್ ಯೋಜನೆ';

            // Add this line to render the content
            renderSharirik();
        });

        // Shakha Guide handler
        document.querySelector('[data-content="shakha"]').addEventListener('click', function () {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById('shakha-screen').classList.add('active');

            document.querySelector('.main-header').style.display = 'none';
            document.querySelector('.content-header').style.display = 'flex';
            document.querySelector('.content-title').textContent = 'ಶಾಖಾ ಕೈಪಿಡಿ';

            // Add this line to render the content
            renderShakha();
        });

        // Add back button handler
        document.querySelector('.back-button').addEventListener('click', function () {
            // Update screens
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById('guide-screen').classList.add('active');

            // Update header
            document.querySelector('.main-header').style.display = 'flex';
            document.querySelector('.content-header').style.display = 'none';
        });

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(function (registration) {
                    console.log('Service Worker registered with scope:', registration.scope);
                })
                .catch(function (error) {
                    console.log('Service Worker registration failed:', error);
                });
        }

        // Install Banner
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installBanner').style.display = 'block';

            document.getElementById('installBtn').addEventListener('click', () => {
                document.getElementById('installBanner').style.display = 'none';
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    gtag('event', 'pwa_install_response', {
                        event_category: 'engagement',
                        event_label: choiceResult.outcome // 'accepted' or 'dismissed'
                    });
                });

                gtag('event', 'pwa_install_prompt', {
                    event_category: 'engagement',
                    event_label: 'Install Prompt Clicked'
                });
            });

            document.getElementById('closeBanner').addEventListener('click', () => {
                document.getElementById('installBanner').style.display = 'none';
            });
        });

        // WhatsApp Sharing
        function shareOnWhatsapp() {
            const shareUrl = window.location.href;
            const shareText = 'Prajnanam - Bengaluru North Vibhag !\n\n';
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText + shareUrl)}`;
            window.open(whatsappUrl, '_blank');

            gtag('event', 'whatsapp_share', {
                event_category: 'engagement',
                event_label: 'WhatsApp Share Button Clicked'
            });
        }

        function trackVirtualPage(screenId) {
            // Map screen IDs to Kannada names
            const screenNames = {
                'home-screen': 'ಮುಖಪುಟ',
                'events-screen': 'ಕಾರ್ಯಕ್ರಮಗಳು',
                'guide-screen': 'ಕೈಪಿಡಿ',
                // Add more if needed
            };
            gtag('event', 'page_view', {
                page_title: screenNames[screenId] || screenId,
                page_location: window.location.href,
                page_path: '/' + screenId
            });
        }

        document.querySelectorAll('.gnanasangama-playstore-link').forEach(link => {
            link.addEventListener('click', function () {
                gtag('event', 'playstore_link_click', {
                    event_category: 'engagement',
                    event_label: 'Gnana Sangama Play Store'
                });
            });
        });

        // For the floating quiz button
        document.getElementById('quiz-float-btn')?.addEventListener('click', function () {
            gtag('event', 'quiz_launch', {
                event_category: 'engagement',
                event_label: 'Quiz Launch Button Clicked'
            });
        });
    </script>

    <!-- Footer -->
    <footer class="text-center py-4" style="color: var(--primary-color); font-size: 0.9rem;">
        <div class="container">

            <a href="https://forms.gle/voubX8XDJjR5jyzc6" target="_blank" rel="noopener" style="text-decoration: none;">
                <div class="card app-card mb-3">
                    <div class="card-body d-flex align-items-center">
                        <i class="bi bi-chat-dots-fill me-3" style="font-size: 2rem; color: var(--primary-color);"></i>
                        <div class="mx-auto">
                            <div class="text-muted" style="font-size: 0.95rem;">
                                ಆಪ್‌ ಅನ್ನು ಇನ್ನಷ್ಟು ಉತ್ತಮವಾಗಿಸಲು
                            </div>
                            <h6 class="mt-2 text-center" style="color: var(--primary-color);">ನಿಮ್ಮ ಸಲಹೆ</h6>
                        </div>
                    </div>
                </div>
            </a>

            <p class="mb-0">
                Handcrafted by
                <a class="gnanasangama-playstore-link"
                    href="https://play.google.com/store/apps/details?id=app.gnanasangama"
                    style="color: var(--primary-color); text-decoration: none; font-weight: 600;">
                    ಜ್ಞಾನ ಸಂಗಮ
                </a>
            </p>
            <small class="text-muted">
                &copy; 2025 ಜ್ಞಾನ ಸಂಗಮ. All rights reserved.
            </small>
        </div>
    </footer>
</body>

</html>